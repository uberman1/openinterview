# Module 2+3 Fix Patch — Node 20 + Static Path (v2)

This patch resolves the two root causes seen in your Module 02 & 03 selftests **and** sets a custom log filename for Module 3.

## Fixes
1) **Node 20 `tsx` loader deprecation** — selftests start the compiled server via `node dist/index.js`.
2) **Static directory mismatch** — update server to serve from `../dist/public` (see `DIFFS.md`).
3) **Custom log name for Module 3** — when `MODULE_NUM=03`, text log is `logs/mod-03a.log`.

## Files
- `scripts.selftest.js` → drop-in replacement for `/scripts/selftest.js` (module-aware; Node 20 compatible; Module 3 logs to `mod-03a.log`)
- `DIFFS.md` → copy/paste diffs for `/server/vite.ts` and `/server/index.ts`

## Apply
1. Replace `/scripts/selftest.js` with this version.
2. Apply diffs in `DIFFS.md` to `/server/vite.ts` (and any references in `/server/index.ts`).
3. Run:
   ```bash
   npm run build
   MODULE_NUM=02 npm test
   MODULE_NUM=03 npm test   # will write logs/mod-03a.log
   ```

## Expected outcome
- Selftests run without `tsx --loader` errors.
- Static files resolved from `../dist/public`.
- Module 03 text log: `logs/mod-03a.log`; JSON remains `logs/selftest.mod-03.json`.
