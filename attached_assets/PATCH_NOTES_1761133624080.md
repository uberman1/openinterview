# OpenInterview – CDN‑less Safety Patch

**Problem:** In sandboxed or test environments (including some Replit previews and headless test runners),
external CDNs like **Tailwind CSS** and **Google Fonts** can be blocked. When that happens, some pages
(e.g., `profile_edit_enhanced.html`) can render as a blank white screen due to missing styles.

**Solution (drop‑in):**
This patch adds a tiny watchdog that detects blocked CDNs and **injects a local minimal `fallback.css`**
so the editor remains readable and interactive even without Tailwind or Google Fonts.

## What’s inside
- `public/css/fallback.css` — small, opinionated base styles (forms, tables, cards, buttons).
- `public/js/cdn-watchdog.js` — detects Tailwind CDN failure and loads the fallback CSS automatically.
- Instructions to wire it in.

## How to install
1) Unzip this bundle into your project root (it will create/merge the `public/css` and `public/js` folders).
2) In **every page** that might rely on Tailwind/Fonts (e.g., `public/profile_edit_enhanced.html`), add the watchdog script **after** your existing `<script src="https://cdn.tailwindcss.com?...">` tag (or anywhere in `<head>`):

```html
<!-- Tailwind CDN (may be blocked in some test environments) -->
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

<!-- CDN Watchdog: auto-injects /css/fallback.css if Tailwind fails -->
<script defer src="/js/cdn-watchdog.js"></script>
```

> If your page doesn't use the Tailwind **script** and instead links a Tailwind **CSS file**, keep the watchdog anyway — it still helps when network policies block stylesheets.

3) (Optional) Force initial visibility, in case any cloaking styles are present during hydration:

```html
<style>html,body{visibility:visible!important;opacity:1!important}</style>
```

## Recommended long‑term hardening
- **Self‑host Tailwind:** Build a local stylesheet and reference it instead of the CDN script.
  ```bash
  # one-time setup
  npm i -D tailwindcss postcss autoprefixer

  # tailwind.config.js (minimal)
  module.exports = { content: ["./public/**/*.html","./public/js/**/*.js"], theme: { extend: {} }, plugins: [require("@tailwindcss/forms")] }

  # src/tailwind.css
  @tailwind base;
  @tailwind components;
  @tailwind utilities;

  # build (add to package.json scripts as "build:css")
  npx tailwindcss -i ./src/tailwind.css -o ./public/css/app.css --minify
  ```
  Then replace the CDN script with:
  ```html
  <link rel="stylesheet" href="/css/app.css">
  ```

- **Font fallbacks:** Prefer a system font stack; add Inter only as a progressive enhancement.

- **Playwright tweak:** In tests, route CDN requests to a local file:
  ```ts
  // example snippet
  await page.route(/cdn\.tailwindcss\.com/, route => route.fulfill({ status:200, contentType:'text/javascript', body:'/* noop in tests */' }));
  ```

## Why this fixes your symptom
When Tailwind is blocked, many utility classes (spacing, layout, visibility) don’t apply, and some setups use
visibility/opacity toggles during hydration. The watchdog guarantees **legible defaults** so your editor stays visible and usable.