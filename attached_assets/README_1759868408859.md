# Password Reset Module (no email integration)

Delivers a complete, non-enumerating **Forgot/Reset password** flow using our Tailwind/Inter look — everything except real email delivery.

## What’s included
- `public/forgot.html` — email form (unauth)
- `public/reset.html` — set new password (unauth)
- `public/js/login.forgot.bind.js` — injects “Forgot password?” link into `login.html` without changing its bytes
- `scripts/apply_password_reset.mjs` — copies files and **patches `index.js`** with:
  - Routes to serve `forgot.html` and `reset.html`
  - Endpoints: `POST /api/auth/forgot`, `GET /api/auth/reset/validate`, `POST /api/auth/reset`
  - A dev helper `GET /dev/last-reset?email=…` to retrieve the reset URL
  - Response-time injection of the login binder for `/login.html`
- `scripts/selftest_password_reset.mjs` — end-to-end flow test (forgot → token → validate → reset → block reuse)

## Security behaviors
- Non-enumerating responses on `/api/auth/forgot`
- Single-use opaque tokens (30-min TTL), stored in `.data/reset_tokens.json`
- Password “hash” is stored **plain for dev only** in `.data/reset_passwords.json` (swap for bcrypt/argon2 in prod)
- Simple rate limits per-IP and per-email

## Apply on Replit
```bash
unzip password_reset_module.zip -d /tmp/pr && cp -R /tmp/pr/* .
node scripts/apply_password_reset.mjs
# restart your server (e.g., npm run dev)
npm i supertest
node scripts/selftest_password_reset.mjs
```

## Integrating with your real auth
- In production, replace the dev password store with your user DB updates (hash passwords!).
- Replace the console/`/dev/last-reset` link emission with your email sender (SendGrid/SES/SMTP).
- Optionally add a post-reset hook to revoke sessions/tokens for the user.
