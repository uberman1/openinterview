<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Email Preview</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet"/>
  <style>
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:#0b0b0b;color:#eee;padding:24px}
    iframe{width:100%;height:90vh;border:1px solid #333;border-radius:12px; background:#fff}
    .meta{margin-bottom:12px;color:#9ca3af}
  </style>
</head>
<body>
  <div class="meta">
    <div id="metaText"></div>
  </div>
  <iframe id="frame"></iframe>
<script type="module">
  const u = new URL(location.href);
  const sender = u.searchParams.get('sender') || 'OpenInterview User';
  const message = u.searchParams.get('message') || '';
  const link = u.searchParams.get('link') || '#';

  document.getElementById('metaText').textContent = `To: (preview) â€¢ From: ${sender}`;

  const html = `<!DOCTYPE html><html><head><meta charset="utf-8"></head><body>${buildEmailHtml(sender, message, link)}</body></html>`;
  const blob = new Blob([html], {type:'text/html'});
  const url = URL.createObjectURL(blob);
  const frame = document.getElementById('frame');
  frame.src = url;
  frame.onload = () => setTimeout(() => URL.revokeObjectURL(url), 10000);

  function esc(s=""){return s.replace(/[&<>"]/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;"}[c]))}
  function buildEmailHtml(senderName, message, link){
    return `
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet"/>
<style>
  body { background:#f7f7f7; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; color:#141414; }
  .card { max-width: 640px; margin: 32px auto; background:#fff; border:1px solid #e5e5e5; border-radius:12px; overflow:hidden; }
  .header, .footer { padding:20px 24px; border-bottom:1px solid #e5e5e5; }
  .footer { border-top:1px solid #e5e5e5; border-bottom:none; text-align:center; color:#6b7280; font-size:12px;}
  .content { padding:24px; }
  .title { font-weight:900; font-size:28px; margin:0 0 8px 0; }
  .msg { background:#f7f7f7; border-radius:10px; padding:16px; color:#374151; font-style:italic; }
  .btn { display:inline-block; padding:12px 20px; border-radius:10px; background:#141414; color:#fff; text-decoration:none; font-weight:700; }
  .muted { color:#6b7280; }
</style>
<div class="card">
  <div class="header"><strong>OpenInterview.me</strong></div>
  <div class="content">
    <h1 class="title">You're invited to view an interview</h1>
    <p class="muted">Hello,</p>
    <p><strong>${esc(senderName)}</strong> has shared a video interview with you on OpenInterview.me.</p>
    ${message ? `<div class="msg">${esc(message)}</div>` : ``}
    <p style="margin:18px 0 4px 0;">
      <a href="${link}" class="btn" target="_blank" rel="noopener">View Interview</a>
    </p>
  </div>
  <div class="footer">
    <a href="#" style="color:#6b7280; text-decoration:none">OpenInterview.me</a> &nbsp;|&nbsp; <a href="#" style="color:#6b7280; text-decoration:none">Unsubscribe</a>
    <div style="margin-top:6px">123 Minimalist St, Suite 101, Executive City, 12345</div>
  </div>
</div>`;
  }
</script>
</body>
</html>
