# OpenInterview — Cloudinary Video + Thumbnail Self‑Deploying Patch

This patch:
- Keeps your current **template thumbnail** as the **default**.
- Adds **Upload Video** (Cloudinary direct upload, signed) and **Upload Thumbnail** buttons to the editor.
- On first **video upload**, replaces the default thumbnail with the video's **first frame** (auto mode).
- If a user uploads a **thumbnail image**, switches to **custom** thumbnail.
- Wires a public-page binder to play HLS/MP4 and respect poster mode (default/auto/custom).

## Install

1. Unzip this folder into your project root (the `patches/` directory should be at the top level).
2. From your project root, run:
   ```bash
   node patches/apply.mjs
   npm install
   ```
3. In Replit/Env vars, set:
   - `CLOUDINARY_CLOUD_NAME`
   - `CLOUDINARY_API_KEY`
   - `CLOUDINARY_API_SECRET`
   - `CLOUDINARY_UPLOAD_PRESET` (signed, resource type: **video/auto**)

The patcher:
- Copies files into `/server`, `/routes`, and `/js`.
- Injects the upload-sign route into your server entry.
- Adds the two editor buttons and module scripts to `profile_edit_enhanced.html`.
- Adds a small public binder and `hls.js` to `index.html`.
- Merges `cloudinary` and `express` into `package.json`.

## Files Added
- `server/cloudinary.js`
- `routes/upload-sign.js`
- `js/cloudinary-helpers.js`
- `js/uploader.js`
- `js/profile-editor.video-thumb.bind.js`
- `js/public-video.bind.js`
- `patches/apply.mjs` (this patcher)

## Notes
- Data model: `profile.video.posterMode` is `'default' | 'auto' | 'custom'`. `posterUrl` used for `auto/custom`.
- The public page leaves your original `<video poster="...">` intact unless `posterMode` switches.
- HLS is loaded via CDN for compatibility.

Enjoy!
