# Module 10 — Admin & Analytics (No new deps)

Goal
- Add protected admin analytics endpoints to summarize usage.
- Basic role check: admin email guard.
- Extend selftest for admin stats and access control.

What’s included
- server/middleware/requireAdmin.ts
- server/admin.routes.ts
- server/routes.ts.patch  (mount admin routes after auth)
- scripts/selftest.js     (unified runner with Module 10 checks)
- README_Module10.md
- guardrails_m10.txt

How to apply
1) Add the middleware and routes files under /server.
2) Edit /server/routes.ts per server/routes.ts.patch:
   - import { mountAdminRoutes } from './admin.routes';
   - call mountAdminRoutes(app, API_BASE) after auth is mounted.
3) Replace /scripts/selftest.js with the one in this archive.
4) Run:
   npm run build
   MODULE_NUM=10 node scripts/selftest.js

Success
- admin.stats requires authentication and admin access.
- Non-admin receives 403.
- Admin receives 200 with totals and breakdowns.
- Selftest prints ALL CHECKS PASSED; logs written.
