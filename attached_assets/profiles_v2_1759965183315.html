<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>OpenInterview â€“ Profiles v2</title>

<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet"/>
<script>
  tailwind.config = {
    darkMode: "class",
    theme: {
      extend: {
        colors: {
          "primary": "#141414",
          "background-light": "#f7f7f7",
          "background-dark": "#191919",
          "foreground-light": "#141414",
          "foreground-dark": "#f7f7f7",
          "subtle-light": "#e5e5e5",
          "subtle-dark": "#2a2a2a"
        },
        fontFamily: { sans: ["Inter", "ui-sans-serif","system-ui","sans-serif"] },
        borderRadius: { "2xl":"1.25rem" }
      }
    }
  }
</script>
<style>
  html, body { font-family: Inter, ui-sans-serif, system-ui, sans-serif; }
</style>

</head>
<body class="bg-background-light text-foreground-light">
  <header class="sticky top-0 z-10 bg-white/70 backdrop-blur border-b border-neutral-200">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <h1 class="text-xl font-bold">Profiles v2</h1>
      <a href="./profile_pagev2.html" class="text-sm underline hover:no-underline">Profile Template</a>
    </div>
  </header>
  <main class="max-w-6xl mx-auto px-4 py-6">
    <div class="mb-4 flex gap-2 items-center">
      <input id="search" type="text" placeholder="Search name, title, location..." class="w-full md:w-1/2 rounded-xl border border-neutral-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-neutral-800"/>
    </div>
    <section id="cards" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></section>
  </main>

  <template id="card-template">
    <article class="rounded-2xl border border-neutral-200 bg-white shadow-sm hover:shadow transition p-4 flex flex-col gap-3">
      <div class="flex items-center gap-3">
        <div class="h-12 w-12 rounded-full bg-neutral-100 flex items-center justify-center text-neutral-600 font-semibold" data-initials></div>
        <div>
          <h2 class="font-semibold leading-tight" data-name></h2>
          <p class="text-sm text-neutral-600" data-title></p>
        </div>
      </div>
      <p class="text-sm text-neutral-700" data-location></p>
      <div class="flex flex-wrap gap-2 text-xs" data-skills></div>
      <a class="mt-auto inline-flex items-center justify-center rounded-xl border border-neutral-300 px-3 py-2 text-sm hover:bg-neutral-50"
         data-link>Open Profile</a>
    </article>
  </template>

  <script>
    async function loadProfiles() {
      const res = await fetch('./data/profiles.json', { cache: 'no-store' });
      if (!res.ok) throw new Error('profiles.json failed to load');
      return res.json();
    }
    function initials(name) {
      return name.split(' ').map(p=>p[0]).slice(0,2).join('').toUpperCase();
    }
    function render(profiles) {
      const tpl = document.getElementById('card-template');
      const host = document.getElementById('cards');
      host.innerHTML = '';
      profiles.forEach(p => {
        const node = tpl.content.cloneNode(true);
        node.querySelector('[data-initials]').textContent = initials(p.name);
        node.querySelector('[data-name]').textContent = p.name;
        node.querySelector('[data-title]').textContent = p.title;
        node.querySelector('[data-location]').textContent = p.location;
        const skills = node.querySelector('[data-skills]');
        (p.skills||[]).slice(0,4).forEach(s=>{
          const span = document.createElement('span');
          span.className = 'px-2 py-1 rounded-full border border-neutral-300';
          span.textContent = s;
          skills.appendChild(span);
        });
        const url = new URL('./profile_pagev2.html', location.href);
        url.searchParams.set('profileId', p.id);
        node.querySelector('[data-link]').href = url.toString();
        host.appendChild(node);
      });
    }
    let all = [];
    loadProfiles().then(ps=>{ all = ps; render(all); }).catch(e=>{
      console.error(e);
      document.getElementById('cards').innerHTML = '<p class="text-red-600">Failed to load profiles.</p>';
    });
    document.getElementById('search').addEventListener('input', (e)=>{
      const q = e.target.value.toLowerCase();
      const f = all.filter(p => [p.name, p.title, p.location, (p.skills||[]).join(' ')].join(' ').toLowerCase().includes(q));
      render(f);
    });
  </script>
<script type="module" src="/js/nav-patch.js"></script>
<script type="module" src="/js/redirect-shim.js"></script>
</body></html>