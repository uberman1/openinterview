# Subscriptions Page — UI Update Patch

This patch:
1) Installs your **exact** Subscription page HTML (`subscription.html`) with Tailwind/Inter.
2) Adds a small **binder** (`subscription.bind.js`) that wires UI actions to your existing routes/APIs:
   - **Nav**: Home / Interviews / Pricing → first available matching routes.
   - **Payment Method – Update**: links to known billing routes; falls back to calling an API that returns `{ url }`.
   - **Manage in Stripe**: opens Stripe portal via known routes or `/api/billing/portal` JSON.
   - **Billing History**: if `/api/billing/history` exists, replaces the static list with real entries.
3) Leaves your backend logic intact (no API changes required). Only a tiny server alias is added to serve this page with the binder.

## Apply (Replit)
```bash
unzip subscriptions_ui_update_patch.zip -d /tmp/oi_sub && cp -R /tmp/oi_sub/* .
node scripts/apply_subscription_ui_update.mjs
# restart server (e.g., npm run dev)
npm i supertest cheerio
node scripts/selftest_subscription_ui.mjs
```

## Routes used (progressive fallbacks)
- **Nav**
  - Home → `/home.html`, `/profile.html`, `/`
  - Interviews → `/interviews.html`, `/interviews`
  - Pricing → `/pricing.html`, `/billing/pricing`, `/pricing`
- **Payment Method – Update**
  - Direct page: `/billing/payment-method`, `/billing/update-payment-method`, `/settings/billing/payment-method`, `/customer/billing/payment-method`
  - JSON: `/api/billing/payment-method`, `/api/billing/setup-intent` → expect `{ url }`
- **Manage in Stripe**
  - Direct page: `/billing/portal`, `/billing/customer-portal`, `/stripe/portal`, `/stripe/customer-portal`
  - JSON: `/api/billing/portal`, `/api/billing/stripe-portal` → expect `{ url }`
- **Billing History**
  - JSON: `/api/billing/history` → expect `[{ id, date, invoice_url }]`

## Guardrails
If `expected.sha256.json` exists, it’s updated with the checksum of `public/subscription.html` so your “exact bytes” policy holds.

## Rollback
```bash
cp -f public/subscription_prev.html public/subscription.html
# Optionally remove SUBSCRIPTION_BIND_INJECT block from index.js
```
